# Scanning & Enumeration

## Scanning with nmap

```
nmap -T4 -p- -A
```
```
nmap -sV -sC -oA $file $IP
```
### nmap Scripting Language

```
nmap -p $PORT --script $NAME -oA $IP
```
Script names can be: safe, vuln, discovery, version,brute, intrusive, auth, broadcast

## Enumerating SMB
### SMB client
```
smbclient -L \\\\192.168.57.134\\
```
```
smbclient \\\\192.168.57.134\\FileShare
```

```
nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse IP
```

### SMB map

```
smbmap -u USER -H IP
smbmap -H IP -R --depth 5
```

To mount smb shares
```
mount -t cifs //IP/folder /mnt/smb
```

## Enumerating Mounts(RPCbind)

```
nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.148.131
```

## Enum4Linux

## Enum telnet

```
telnet IP PORT
```

### check for pings (tcpdump)

```
Listener 
sudo tcpdump ip proto \\icmp -i tun0

ping IP -c 1
```

## FTP

```
ftp IP
anonymous login
```
## Additional Scanning Tools

### Masscan

```
mass -p1-65535 --rate 1000 192.168.57.134
```
### Autorecon
https://github.com/Tib3rius/AutoRecon